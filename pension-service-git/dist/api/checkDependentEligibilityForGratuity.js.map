{"version":3,"sources":["../../src/api/checkDependentEligibilityForGratuity.js"],"names":["asyncHandler","require","config","db","api","post","res","next","body","i","ProcessInstances","dependents","length","dob","isDisabled","maritalStatus","isHollyDependent","noSpouseNoChildren","isGrandChildFromDeceasedSon","isEligibleForGratuity","isEligibleForPension","eligibilityRespone","console","log","JSON","stringify","Dependents","processInstances","push","response","ResponseInfo","RequestInfo","json"],"mappings":"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","file":"checkDependentEligibilityForGratuity.js","sourcesContent":["import { Router } from \"express\";\r\nimport producer from \"../kafka/producer\";\r\nimport { requestInfoToResponseInfo,convertDateToEpoch, epochToYmd,getDependentEligibilityForGratuity} from \"../utils\";\r\nimport envVariables from \"../envVariables\";\r\nimport mdmsData from \"../utils/mdmsData\";\r\nimport { addUUIDAndAuditDetails } from \"../utils/create\";\r\nimport isEmpty from \"lodash/isEmpty\";\r\nimport set from \"lodash/set\";\r\nimport get from \"lodash/get\";\r\nimport orderBy from \"lodash/orderBy\";\r\nimport { intConversion} from \"../utils/search\";\r\nconst asyncHandler = require(\"express-async-handler\");\r\n\r\nexport default ({ config, db }) => {\r\n  let api = Router();\r\n  api.post(\r\n    \"/_checkDependentEligibilityForGratuity\",\r\n    asyncHandler(async ({ body }, res, next) => {              \r\n     \r\n      for (var i = 0; i < body.ProcessInstances[0].dependents.length; i++) {                 \r\n        body.ProcessInstances[0].dependents[i].dob=epochToYmd(intConversion(body.ProcessInstances[0].dependents[i].dob));\r\n        body.ProcessInstances[0].dependents[i].isDisabled=body.ProcessInstances[0].dependents[i].isDisabled?body.ProcessInstances[0].dependents[i].isDisabled:false;\r\n        body.ProcessInstances[0].dependents[i].maritalStatus=body.ProcessInstances[0].dependents[i].maritalStatus?body.ProcessInstances[0].dependents[i].maritalStatus:false;\r\n        body.ProcessInstances[0].dependents[i].isHollyDependent=body.ProcessInstances[0].dependents[i].isHollyDependent?body.ProcessInstances[0].dependents[i].isHollyDependent:false;\r\n        body.ProcessInstances[0].dependents[i].noSpouseNoChildren=body.ProcessInstances[0].dependents[i].noSpouseNoChildren?body.ProcessInstances[0].dependents[i].noSpouseNoChildren:false;\r\n        body.ProcessInstances[0].dependents[i].isGrandChildFromDeceasedSon=body.ProcessInstances[0].dependents[i].isGrandChildFromDeceasedSon?body.ProcessInstances[0].dependents[i].isGrandChildFromDeceasedSon:false;\r\n        body.ProcessInstances[0].dependents[i].isEligibleForGratuity=false;\r\n        body.ProcessInstances[0].dependents[i].isEligibleForPension=false;\r\n      }\r\n      \r\n\r\n      let eligibilityRespone=await getDependentEligibilityForGratuity(body);\r\n\r\n      console.log(\"eligibilityRespone\",JSON.stringify(eligibilityRespone));\r\n      let dependents=eligibilityRespone.Dependents;\r\n      for (var i = 0; i < dependents.length; i++) {  \r\n        dependents[i].dob=convertDateToEpoch(dependents[i].dob,\"dob\");\r\n      }\r\n              \r\n      let processInstances=[];\r\n      processInstances.push({\r\n        dependents\r\n        });\r\n\r\n        let response = {\r\n          ResponseInfo: requestInfoToResponseInfo(body.RequestInfo, true),\r\n          ProcessInstances: processInstances          \r\n        };\r\n        \r\n        \r\n        res.json(response);     \r\n        \r\n    })\r\n  );\r\n  return api;\r\n};\r\n"]}